
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tensordb.TensorClient &#8212; TensorDB 0.1 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="tensordb.TensorClient.add_tensor_definition" href="tensordb.TensorClient.add_tensor_definition.html" />
    <link rel="prev" title="TensorClient" href="../tensor_client.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../index.html">
<p class="title">TensorDB</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../tensor_client.html">
  TensorClient
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../base_storage.html">
  BaseStorage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../cached_tensor_handler.html">
  CachedTensorHandler
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../zarr_storage.html">
  ZarrStorage
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   tensordb.TensorClient
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.add_tensor_definition.html">
   tensordb.TensorClient.add_tensor_definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.create_tensor.html">
   tensordb.TensorClient.create_tensor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.get_tensor_definition.html">
   tensordb.TensorClient.get_tensor_definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.get_storage_tensor_definition.html">
   tensordb.TensorClient.get_storage_tensor_definition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.exist_tensor_definition.html">
   tensordb.TensorClient.exist_tensor_definition
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html">
   tensordb.TensorClient.storage_method_caller
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.read.html">
   tensordb.TensorClient.read
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.store.html">
   tensordb.TensorClient.store
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.append.html">
   tensordb.TensorClient.append
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.update.html">
   tensordb.TensorClient.update
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.upsert.html">
   tensordb.TensorClient.upsert
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.backup.html">
   tensordb.TensorClient.backup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.update_from_backup.html">
   tensordb.TensorClient.update_from_backup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.set_attrs.html">
   tensordb.TensorClient.set_attrs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.get_attrs.html">
   tensordb.TensorClient.get_attrs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.close.html">
   tensordb.TensorClient.close
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.delete_file.html">
   tensordb.TensorClient.delete_file
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.exist.html">
   tensordb.TensorClient.exist
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.get_cached_tensor_manager.html">
   tensordb.TensorClient.get_cached_tensor_manager
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tensordb.TensorClient.read_from_formula.html">
   tensordb.TensorClient.read_from_formula
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="tensordb-tensorclient">
<h1>tensordb.TensorClient<a class="headerlink" href="#tensordb-tensorclient" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="tensordb.TensorClient">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">tensordb.</span></span><span class="sig-name descname"><span class="pre">TensorClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_base_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">collections.abc.MutableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_base_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">collections.abc.MutableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_files_on_disk</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synchronizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensordb.TensorClient" title="Permalink to this definition">¶</a></dt>
<dd><p>It’s client designed to handle tensor data in a simpler way and it’s built with Xarray,
it can support the same files than Xarray but those formats needs to be implemented
using the <cite>BaseStorage</cite> interface proposed in this package.</p>
<p>As we can create Tensors with multiple Storage that needs differents settings or parameters we must create
a “Tensor Definition” which is basically a dictionary that specify the behaviour that you want to have
every time you call a method of one Storage. The definitions are very simple to create (there are few internal keys)
, you only need to use as key the name of your method and as value a dictionary containing all the necessary
parameters to use it, you can see some examples in the <code class="docutils literal notranslate"><span class="pre">Examples</span></code> section</p>
<dl class="simple">
<dt>Additional features:</dt><dd><ol class="arabic simple">
<li><p>Support for any backup system that implements the MutableMapping interface.</p></li>
<li><p>Creation or modification of new tensors using dynamic string formulas (even python code (string)).</p></li>
<li><p>The read method return a lazy Xarray DataArray instead of only retrieve the data.</p></li>
<li><p>It’s easy to inherit the class and add customized methods.</p></li>
<li><p>The backups can be faster and saver because you can modify them as you want, an example of this is the
ZarrStorage which has a checksum (currently only store a date for debug porpuse) of every chunk of every
tensor stored to avoid uploading or downloading unnecessary data and is useful to check
the integrity of the data.</p></li>
<li><p>You can use any storage supported by the Zarr protocole to store your data using the ZarrStorage class,
so you don’t have to always use files, you can even store the tensors in
<a class="reference external" href="https://zarr.readthedocs.io/en/stable/api/storage.html.">MongoDB</a></p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>local_base_map: MutableMapping</strong></dt><dd><p>MutableMapping instaciated with the local path that you want to use to store all tensors.</p>
</dd>
<dt><strong>backup_base_map: MutableMapping</strong></dt><dd><p>MutableMapping instaciated with the backup path that you want to use to store all tensors.</p>
</dd>
<dt><strong>synchronizer: str</strong></dt><dd><p>Some of the Storages used to handle the files support a synchronizer, this parameter is used as a default
synchronizer option for everyone of them (you can pass different synchronizer to every tensor).</p>
</dd>
<dt><strong>**kwargs: Dict</strong></dt><dd><p>Useful when you want to inherent from this class.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Store and read a simple tensor:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tensordb</span> <span class="kn">import</span> <span class="n">TensorClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">xarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">fsspec</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span> <span class="o">=</span> <span class="n">TensorClient</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">local_base_map</span><span class="o">=</span><span class="n">fsspec</span><span class="o">.</span><span class="n">get_mapper</span><span class="p">(</span><span class="s1">&#39;test_db&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">backup_base_map</span><span class="o">=</span><span class="n">fsspec</span><span class="o">.</span><span class="n">get_mapper</span><span class="p">(</span><span class="s1">&#39;test_db&#39;</span> <span class="o">+</span> <span class="s1">&#39;/backup&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">synchronizer</span><span class="o">=</span><span class="s1">&#39;thread&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Adding an empty tensor definition (there is no personalization)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">add_tensor_definition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">tensor_id</span><span class="o">=</span><span class="s1">&#39;dummy_tensor_definition&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">new_data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="c1"># This key is used for modify options of the Storage constructor</span>
<span class="gp">... </span>        <span class="c1"># (documented on the reserved keys section of this method)</span>
<span class="gp">... </span>        <span class="s1">&#39;handler&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="c1"># modify the default Storage for the zarr_storage</span>
<span class="gp">... </span>            <span class="s1">&#39;data_handler&#39;</span><span class="p">:</span> <span class="s1">&#39;zarr_storage&#39;</span>
<span class="gp">... </span>        <span class="p">}</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a new empty tensor, you must always call this method to start using the tensor.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">create_tensor</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;tensor1&#39;</span><span class="p">,</span> <span class="n">tensor_definition</span><span class="o">=</span><span class="s1">&#39;dummy_tensor_definition&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<span class="gp">... </span>    <span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span> <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))},</span>
<span class="gp">... </span>    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Storing tensor1 on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;tensor1&#39;</span><span class="p">,</span> <span class="n">new_data</span><span class="o">=</span><span class="n">new_data</span><span class="p">)</span>
<span class="go">&lt;xarray.backends.zarr.ZarrStore object at 0x000001FFBE9ADB80&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reading the tensor1 (normally you will get a lazy Xarray (use dask in the backend))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;tensor1&#39;</span><span class="p">)</span>
<span class="go">&lt;xarray.DataArray &#39;data&#39; (index: 3, columns: 3)&gt;</span>
<span class="go">array([[0., 0., 0.],</span>
<span class="go">       [0., 0., 0.],</span>
<span class="go">       [0., 0., 0.]])</span>
<span class="go">Coordinates:</span>
<span class="go">  * columns  (columns) int32 0 1 2</span>
<span class="go">  * index    (index) int32 0 1 2</span>
</pre></div>
</div>
<p>Storing a tensor from a string formula (if you want to create an ‘on the fly’ tensor using formula see
the docs <a class="reference internal" href="tensordb.TensorClient.read_from_formula.html#tensordb.TensorClient.read_from_formula" title="tensordb.TensorClient.read_from_formula"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.read_from_formula()</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creating a new tensor definition using a formula that depend on the previous stored tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">add_tensor_definition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">tensor_id</span><span class="o">=</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">new_data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s1">&#39;store&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="c1"># read the docs of this method to understand the behaviour of the data_methods key</span>
<span class="gp">... </span>            <span class="s1">&#39;data_methods&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;read_from_formula&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="s1">&#39;read_from_formula&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;`tensor1` + 1 + `tensor1` * 10&#39;</span>
<span class="gp">... </span>        <span class="p">}</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a new empty tensor, you must always call this method to start using the tensor.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">create_tensor</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">,</span> <span class="n">tensor_definition</span><span class="o">=</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Storing tensor_formula on disk, check that now we do not need to send the new_data parameter, because it is generated</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># from the formula that we create previously</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">)</span>
<span class="go">&lt;xarray.backends.zarr.ZarrStore object at 0x000001FFBEA93C40&gt;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reading the tensor_formula (normally you will get a lazy Xarray (use dask in the backend))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">)</span>
<span class="go">&lt;xarray.DataArray &#39;data&#39; (index: 3, columns: 3)&gt;</span>
<span class="go">array([[1., 1., 1.],</span>
<span class="go">       [1., 1., 1.],</span>
<span class="go">       [1., 1., 1.]])</span>
<span class="go">Coordinates:</span>
<span class="go">  * columns  (columns) int32 0 1 2</span>
<span class="go">  * index    (index) int32 0 1 2</span>
</pre></div>
</div>
<p>Appending a new row and a new column to a tensor:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Appending a new row and a new columns to the tensor_formula stored previously</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_data</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<span class="gp">... </span>    <span class="mf">2.</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))},</span>
<span class="gp">... </span>    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Appending the data, you can use the compute=False parameter if you dont want to execute this immediately</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">,</span> <span class="n">new_data</span><span class="o">=</span><span class="n">new_data</span><span class="p">)</span>
<span class="go">[&lt;xarray.backends.zarr.ZarrStore object at 0x000001FFBEB77AC0&gt;, &lt;xarray.backends.zarr.ZarrStore object at 0x000001FFBEB779A0&gt;]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reading the tensor_formula (normally you will get a lazy Xarray (use dask in the backend))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_client</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;tensor_formula&#39;</span><span class="p">)</span>
<span class="go">&lt;xarray.DataArray &#39;data&#39; (index: 4, columns: 4)&gt;</span>
<span class="go">array([[ 1.,  1.,  1., nan],</span>
<span class="go">       [ 1.,  1.,  1., nan],</span>
<span class="go">       [ 1.,  1.,  1., nan],</span>
<span class="go">       [ 2.,  2.,  2.,  2.]])</span>
<span class="go">Coordinates:</span>
<span class="go">  * columns  (columns) int32 0 1 2 3</span>
<span class="go">  * index    (index) int32 0 1 2 3</span>
</pre></div>
</div>
<dl class="simple">
<dt>TODO:</dt><dd><ol class="arabic simple">
<li><p>Add more examples to the documentation</p></li>
</ol>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tensordb.TensorClient.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_base_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">collections.abc.MutableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_base_map</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">collections.abc.MutableMapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_files_on_disk</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synchronizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tensordb.TensorClient.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#tensordb.TensorClient.__init__" title="tensordb.TensorClient.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(local_base_map, backup_base_map[, …])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.add_tensor_definition.html#tensordb.TensorClient.add_tensor_definition" title="tensordb.TensorClient.add_tensor_definition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_tensor_definition</span></code></a>(tensor_id, new_data)</p></td>
<td><p>Add (store) a new tensor definition (internally is stored as a JSON file).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.append.html#tensordb.TensorClient.append" title="tensordb.TensorClient.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with append as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.backup.html#tensordb.TensorClient.backup" title="tensordb.TensorClient.backup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backup</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with backup as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.close.html#tensordb.TensorClient.close" title="tensordb.TensorClient.close"><code class="xref py py-obj docutils literal notranslate"><span class="pre">close</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with close as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.create_tensor.html#tensordb.TensorClient.create_tensor" title="tensordb.TensorClient.create_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_tensor</span></code></a>(path, tensor_definition, **kwargs)</p></td>
<td><p>Create the path and the first file of the tensor which store the necessary metadata to use it, this method must always be called before start to write in the tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.delete_file.html#tensordb.TensorClient.delete_file" title="tensordb.TensorClient.delete_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_file</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with delete_file as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.exist.html#tensordb.TensorClient.exist" title="tensordb.TensorClient.exist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exist</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with exist as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.exist_tensor_definition.html#tensordb.TensorClient.exist_tensor_definition" title="tensordb.TensorClient.exist_tensor_definition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exist_tensor_definition</span></code></a>(path)</p></td>
<td><p>Check if exist an specific definition.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ffill</span></code>(handler, new_data, dim, action_type[, …])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fillna</span></code>(new_data[, value])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.get_attrs.html#tensordb.TensorClient.get_attrs" title="tensordb.TensorClient.get_attrs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_attrs</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with get_attrs as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.get_cached_tensor_manager.html#tensordb.TensorClient.get_cached_tensor_manager" title="tensordb.TensorClient.get_cached_tensor_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cached_tensor_manager</span></code></a>(path, …)</p></td>
<td><p>Create a <cite>CachedTensorHandler</cite> object which is used for multiples writes of the same file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.get_storage_tensor_definition.html#tensordb.TensorClient.get_storage_tensor_definition" title="tensordb.TensorClient.get_storage_tensor_definition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_storage_tensor_definition</span></code></a>(path)</p></td>
<td><p>Retrieve the tensor definition of an specific tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.get_tensor_definition.html#tensordb.TensorClient.get_tensor_definition" title="tensordb.TensorClient.get_tensor_definition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_tensor_definition</span></code></a>(name)</p></td>
<td><p>Retrieve a created tensor definition.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">last_valid_dim</span></code>(new_data, dim, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.read.html#tensordb.TensorClient.read" title="tensordb.TensorClient.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with read as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.read_from_formula.html#tensordb.TensorClient.read_from_formula" title="tensordb.TensorClient.read_from_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_from_formula</span></code></a>([tensor_definition, …])</p></td>
<td><p>This is one of the most important methods of the <cite>TensorClient</cite> class, basically it allows to define formulas that use the tensors stored with a simple strings, so you can create new tensors from this formulas (make use of python eval and the same syntax that you use with Xarray).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reindex</span></code>(new_data, reindex_path, …[, …])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">replace_last_valid_dim</span></code>(new_data, …[, …])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">replace_values</span></code>(new_data, replace_path[, value])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.set_attrs.html#tensordb.TensorClient.set_attrs" title="tensordb.TensorClient.set_attrs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_attrs</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with set_attrs as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-obj docutils literal notranslate"><span class="pre">storage_method_caller</span></code></a>(path, method_name, …)</p></td>
<td><p>Calls an specific method of a Storage, this include send the parameters specified in the tensor_definition or modifying the behaviour of the method based in your tensor_definition (read <a class="reference internal" href="tensordb.TensorClient.add_tensor_definition.html#tensordb.TensorClient.add_tensor_definition" title="tensordb.TensorClient.add_tensor_definition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.add_tensor_definition()</span></code></a> for more info of how to personalize your method).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.store.html#tensordb.TensorClient.store" title="tensordb.TensorClient.store"><code class="xref py py-obj docutils literal notranslate"><span class="pre">store</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with store as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.update.html#tensordb.TensorClient.update" title="tensordb.TensorClient.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with update as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tensordb.TensorClient.update_from_backup.html#tensordb.TensorClient.update_from_backup" title="tensordb.TensorClient.update_from_backup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_from_backup</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with update_from_backup as method_name (has the same parameters).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tensordb.TensorClient.upsert.html#tensordb.TensorClient.upsert" title="tensordb.TensorClient.upsert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upsert</span></code></a>(path, **kwargs)</p></td>
<td><p>Calls <a class="reference internal" href="tensordb.TensorClient.storage_method_caller.html#tensordb.TensorClient.storage_method_caller" title="tensordb.TensorClient.storage_method_caller"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TensorClient.storage_method_caller()</span></code></a> with upsert as method_name (has the same parameters).</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="../tensor_client.html" title="previous page">TensorClient</a>
    <a class='right-next' id="next-link" href="tensordb.TensorClient.add_tensor_definition.html" title="next page">tensordb.TensorClient.add_tensor_definition</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Joseph Nowak.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>